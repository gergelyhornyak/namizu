<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Countdown Form</title>
  <script>
    let seconds = 30;
    let countdownStarted = false;

    function startCountdown() {
      if (countdownStarted) return;
      countdownStarted = true;

      document.getElementById("startBtn").disabled = true;
      const timer = document.getElementById('timer');

      const interval = setInterval(() => {
        seconds--;
        timer.textContent = `⏳ Time left: ${seconds}s`;

        if (seconds <= 0) {
          clearInterval(interval);
          autoSubmit();
        }
      }, 1000);
    }

    function autoSubmit() {
      const formData = {
        country: document.getElementById("country").value,
        city: document.getElementById("city").value,
        food: document.getElementById("food").value,
        animal: document.getElementById("animal").value,
        person: document.getElementById("person").value
      };

      fetch('/submit', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById("result").textContent = "✅ Submitted automatically!";
        console.log("Response:", data);
      });
    }
  </script>
</head>
<body>
  <h1>Guessing Game</h1>

  <button id="startBtn" onclick="startCountdown()">▶️ Start Countdown</button>
  <div id="timer">⏳ Time left: --</div>

  <form onsubmit="event.preventDefault(); autoSubmit();">
    <label>Ország: <input type="text" id="country" /></label><br />
    <label>Város: <input type="text" id="city" /></label><br />
    <label>Kaja: <input type="text" id="food" /></label><br />
    <label>Állat: <input type="text" id="animal" /></label><br />
    <label>Személynév: <input type="text" id="person" /></label><br />
  </form>

  <p id="result"></p>
</body>
</html>
